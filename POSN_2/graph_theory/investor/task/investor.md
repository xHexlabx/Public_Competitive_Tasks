# นักลงทุน (Investor)

<p>
เจแปน หม่า เป็นนักลงทุนธุรกิจเกี่ยวกับแผงการค้า โดยเจแปนนั้นอยากที่จะลงทุนในแผงการค้าในเมือง "สลิกทาวน์" เพราะในเมืองเมืองนี้มีกลุ่มผู้ขายในจำนวนที่เหมาะสม และ มีอัตราการเจริญเติบโตของตลาดที่ดีทำให้เจแปนเลือกที่จะมาลงทุนที่เมืองเมืองนี้ โดยจากการทำการวิเคราะห์การตลาดของเจแปนนั้น พบว่าแผงการค้าในเมืองเมืองนี้<b>มีลักษณะที่เรียงต่อกันเป็นเส้นตรงจำนวน $N$ แผง</b>  โดยแต่ละแผงการค้านั้นมีเจ้าของที่แตกต่างกัน และจะ<b>มีมูลค่าเริ่มต้นค่าหนึ่ง</b>จากการทำธุรกิจที่ผ่าน ๆ มา นอกจากนี้เจแปนสังเกตว่าเจ้าของแผงการค้าต่าง ๆ นั้น <b>สามารถตกลงรวมกลุ่มกันทำธุรกิจเพื่อเพิ่มมูลค่าของ "กลุ่มธุรกิจ" ได้</b> โดยการรวมกลุ่มธุรกิจนั้นจะเป็นการตกลงกันระหว่างตัวแทนจากกลุ่มธุรกิจต่าง ๆ เพื่อรวมกลุ่มธุรกิจของทั้งสองเข้าด้วยกัน ทั้งนี้แผงการค้าเพียงหนึ่งแผงก็นับว่าเป็น "กลุ่มธุรกิจ" ตัวอย่างในการรวมกลุ่มธุรกิจ :  
	<ul>
		<li>มีแผงการค้าเริ่มต้นอยู่ 3 แผงนับว่ามี 3 กลุ่มธุรกิจ</li>
		<li>ต่อมา หากแผงการค้าแผงที่ 1 จับกลุ่มกับแผงการค้าที่ 2 จะได้ว่า มีกลุ่มธุรกิจ 2 กลุ่ม คือกลุ่มของแผงการค้า 1 , 2 และกลุ่มของแผงการค้า 3</li>
		<li><b>การรวมกลุ่มธุรกิจนั้นจะเป็นการรวมมูลค่าของแผงการค้านั้นเข้าด้วยกัน</b>เช่น แผงการค้าที่ 1 , 2 , 3 มีมูลค่าเริ่มต้น 10 , 20 , 30 หน่วยตามลำดับ เมื่อรวมกลุ่มธุรกิจของแผงการค้าที่ 1 และ 2 จะทำให้แผงการค้าที่ 1 ถือว่ามีมูลค่าเป็น 10 + 20 = 30 หน่วย และ แผงการค้าที่ 2 มีมูลค่า 10 + 20 = 30 หน่วยเช่นกัน (กลุ่มธุรกิจเดียวกัน ย่อมมีมูลค่าเท่ากัน) ส่วนแผงการค้าที่ 3 มีมูลค่าเป็น 30 หน่วยเช่นเดิม</li>
		<li>หากมีการรวมกลุ่มธุรกิจของแผงการค้าที่ 2 และ 3 จะถือว่าแผงการค้าที่ 1 ที่เคยรวมกลุ่มธุรกิจกับแผงการค้าที่ 2 เป็นกลุ่มธุรกิจเดียวกับแผงการค้าที่ 3 ด้วย และจะทำให้แผงการค้าทั้งสามมีมูลค่า 10 + 20 + 30 = 60 หน่วยเท่ากันหมด</li>
		<li>หากเกิดเหตุการณ์ที่เกิดการรวมกลุ่มซ้ำของแผงการค้าที่เป็นกลุ่มธุรกิจเดียวกันอยู่แล้วจะถือว่าร้านค้าที่สองสร้างดีลธุรกิจต่อกัน ทำให้กลุ่มธุรกิจนั้น<b>มีมูลค่าเพิ่มเท่ากับมูลค่าเริ่มต้น</b>ของแผงการค้าทั้งสอง เช่น หากแผงการค้าที่ 2 และ 3 รวมกลุ่มซ้ำต่อกันถือว่าแผงการค้าทั้งสองสร้างดีลเพิ่มขึ้นทำให้มูลค่าของกลุ่มธุรกิจกลุ่มนี้เพิ่มเป็น 60 + 20 + 30 = 110 หน่วย (20 และ 30 เป็นมูลค่าเริ่มต้นของแผงการค้าที่ 2 และ 3 ตามลำดับ) และทำให้มูลค่าของแผงการค้าที่ 1 นั้นมีมูลค่าเป็น 110 หน่วยด้วย (กลุ่มธุรกิจเดียวกันย่อมมีมูลค่าเท่ากัน)</li>
	</ul>
	เจแปนนั้นเล็งเห็นว่าหากกลุ่มธุรกิจใด ๆ มีมูลค่าที่ดีจะเป็นกลุ่มธุรกิจที่แข็งแรงและน่าลงทุนเป็นอย่างมาก นอกจากนั้นเจแปนสังเกตว่ากลุ่มธุรกิจที่ดีนั้น  จะมี<b>ระยะขอบเขตแผงการค้า</b>ที่มากโดยเป็นอีกเงื่อนไขของการลงทุน โดยระยะขอบเขตแผงการค้าของกลุ่มธุรกิจใด ๆ สามารถวิเคราะห์ได้จาก (เลขแผงการค้าในกลุ่มธุรกิจที่อยู่ท้ายสุด - เลขแผงการค้าในกลุ่มธุรกิจที่อยู่ต้นที่สุด + 1)
<div style="page-break-after: always;"></div>
	
	
ตัวอย่างในการวิเคราะห์ขอบเขตแผงการค้า : 
<ul>
	<li>มีแผงการค้าเริ่มต้นอยู่ 5 แผงนับว่ามี 5 กลุ่มธุรกิจ</li>
	<li>แผงการค้าที่ 1 และ 4 จับกลุ่มธุรกิจกัน และ แผงการค้าที่ 2 และ 3 จับกลุ่มธุรกิจกัน จะถือว่าขอบเขตแผงการค้าของแผงการค้าที่ 1 และ 4 นั้นมีค่าเท่ากับ (4 - 1 + 1) = 4 หน่วย (กลุ่มธุรกิจเดียวกันย่อมมีขอบเขตของแผงการค้าเท่ากัน) และ ขอบเขตแผงการค้าของแผงการค้าที่ 2 และ 3 นั้นมีค่าเท่ากับ (3 - 2 + 1) = 2 หน่วย และ ขอบเขตแผงการค้าของแผงการค้าที่ 5 นั้นมีค่าเท่ากับ (5 - 5 + 1) = 1 หน่วย</li>
	<li>ต่อมา หากมีการจับกลุ่มธุรกิจระหว่างแผงการค้าที่ 4 และ 5 จะทำให้ขอบเขตแผงการค้าของแผงการค้าที่ 1 , 4 , 5 มีค่าเท่ากับ (5 - 1 + 1) = 5 หน่วย (เมื่อจับกลุ่มกันแล้วถือว่าแผงการค้าที่อยู่ต้นที่สุดคือแผงการค้าที่ 1 และแผงการค้าที่อยู่ท้ายที่สุดคือแผงการค้าที่ 5)</li>
	
</ul>
ทั้งนี้เจแปนที่ต้องการติดตามเหตุการณ์และเลือกลงทุนต้องการให้คุณเขียนโปรแกรมเพื่อรายงานมูลค่าของแผงการค้า และ ขอบเขตของแผงการค้าแบบเรียลไทม์ โดยมีคำสั่ง 4 รูปแบบด้วยกัน

รายละเอียดของคำสั่งมีดังนี้
<ul>
	<li>1. คำสั่ง A รับจำนวนเต็ม x และ y แทนเหตุการณ์ที่แผงการค่า x และ y ทำการรวมกลุ่มธุรกิจเข้าด้วยกัน หากแผงการค่าที่ x และ y เป็นแผงการค้าที่เป็นกลุ่มธุรกิจเดียวกันอยู่แล้วจะเป็นการเพิ่มมูลค่าของกลุ่มธุรกิจดังที่ระบุไว้ข้างต้น</li>
	<li>2. คำสั่ง B รับจำนวนเต็ม x โดยให้แสดงผลขอบเขตแผงการค้าของกลุ่มธุรกิจที่แผงการค้าที่ x อยู่ แล้วเว้นบรรทัด</li>
	<li>3. คำสั่ง C รับจำนวนเต็ม x โดยให้แสดงผลมูลค่าของกลุ่มธุรกิจที่แผงการค้าที่ x อยู่ แล้วเว้นบรรทัด</li>
	<li>4. คำสั่ง D รับจำนวนเต็ม x โดยให้แสดงผลขอบเขตแผงการค้าของของกลุ่มธุรกิจที่แผงการค้าที่ x อยู่ เว้นวรรค แล้วจึงแสดงผลมูลค่าของกลุ่มธุรกิจที่แผงการค้าที่ x อยู่ แล้วเว้นบรรทัด</li></li>
</ul>
</p>


## Input

บรรทัดแรก : รับจำนวนเต็ม $N$ , $Q$ แทนจำนวนแผงการค้าทั้งหมด และ จำนวนคำสั่งทั้งหมดที่เกิดขึ้น

บรรทัดถัดมา : รับจำนวนเต็ม $V_1 -V_n$ แทนมูลค่าเริ่มต้นของแผงการค้าต่าง ๆ (มูลค่าเริ่มต้นจะไม่เปลี่ยนแปลงแม้ว่าจะเกิดการรวมกลุ่มธุรกิจ)

$Q$ บรรทัดถัดมา : รับอักขระ $M$ แทน รูปแบบของคำสั่งที่เกิดขึ้น โดยมีรายละเอียดคำสั่งดังที่ระบุไว้ข้างต้น 

## Output

จำนวนเต็มแทนขอบเขตแผงการค้า หรือ มูลค่าของกลุ่มธุรกิจตามที่ระบุไว้ในคำสั่ง
<div style="page-break-after: always;"></div>

## Examples
### ตัวอย่างที่ 1

<table width=100%><tr align="center"><th>ข้อมูลนำเข้า</th><th>ข้อมูลส่งออก</th></tr>
<tr><td width=50% style="vertical-align:top"><pre style="background-color: transparent; border:0;">
5 6
5 3 4 8 6
A 2 3
B 2
A 3 4
C 3
A 1 5
D 1
</pre></td><td style="vertical-align:top"><pre style="background-color: transparent; border:0;">
2
15
5 11
</pre></td></tr>
</table>

### ตัวอย่างที่ 2

<table width=100%><tr align="center"><th>ข้อมูลนำเข้า</th><th>ข้อมูลส่งออก</th></tr>
<tr><td width=50% style="vertical-align:top"><pre style="background-color: transparent; border:0;">
5 5
1 2 3 4 5
A 1 2
A 2 3
A 1 2
A 1 2
D 3
</pre></td><td style="vertical-align:top"><pre style="background-color: transparent; border:0;">
3 12
</pre></td></tr>
	
</table>

<div style="page-break-after: always;"></div>

## Constraints
* $1\leq N , Q \leq 2\cdot10$<sup>$5$</sup> 
* $1 \leq V_i\leq 10^3$ 

## Subtasks
1. (10 points)  $1\leq N , Q  \leq 100 $ และมีคำสั่งเพียง A และ C 
2. (10 points) $1\leq N , Q  \leq 2 \cdot10 ^ 4 $ และมีคำสั่งเพียง A และ C
3. (30 points) $1\leq N , Q  \leq 2 \cdot10 ^ 4$ 
4. (20 points) $1\leq N , Q  \leq 2 \cdot10 ^ 5$  และมีคำสั่งเพียง A และ C
5. (30 points) $1\leq N , Q  \leq 2 \cdot10 ^ 5$

## Limits
* Time limit: 1.0 seconds
* Memory limit: 32 MB

## Author
* ผู้ออกโจทย์ : ธีร์ เหมจินดา ( HexTex ) 
* *** โจทย์เหล่านี้ออกมีจุดประสงค์ในการพัฒนาผู้มีความสนใจด้าน Competitive Programming อนุญาตให้นำไปใช้ในด้านการศึกษาได้ หากมีข้อผิดพลาดหรือข้อสอบถาม สามารถติดต่อสอบถามผู้ออกโจทย์ได้ เพื่อจะได้นำโจทย์ไปแก้ไขต่อไป ***

## Contacts
* Github : xHexlabx 
* Facebook : ธีร์ เหมจินดา
* Instagram : hextex.ipynb